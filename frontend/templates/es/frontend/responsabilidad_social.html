{% extends 'layouts/interior.html' %}
{% load static %}
{% block otherstyles %}
    <link rel="stylesheet" href="/static/stylesheets/tania.css">
    <link rel="stylesheet" href="/static/stylesheets/david.css">
    <link rel="stylesheet" href="/static/stylesheets/carla.css">
    <link rel="stylesheet" href="/static/stylesheets/carrousel.css">

    <style>
        h1 {
            font-weight: bold;
        }

        :root {
            --verde: #d0df00;
            --gris: #63666A;
            --azul: #243881;
            --blanco: #F5F5F5;
            --morado: #5B2B84;
        }

        #integracion .col-md-4 {
            height: 300px;
        }

        #integracion .col-md-4:hover .layer {
            height: 300px;
        }

        .caja {
            transition: all .2s ease;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            height: 200px;
        }

        .caja:hover {
            scale: 103%;
        }

        .estra-link.panel {
            width: 680px;
            height: 65.33px;
            background-size: contain !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
            border: 1.5px solid #bdbdbd;
            transition: transform .25s ease, border .25s ease, box-shadow .25s ease;
        }
        .estra-link.panel .panel-heading,
        .estra-link.panel .boton-info1 {
            background: transparent !important;
        }
        .estra-link.panel.active {
            transform: scale(1.04);
            border: 3px solid #63666A;
            box-shadow: 0 6px 14px rgba(0,0,0,.12);
        }
        .accordion-event [data-item="primero"] { background-image: url('{% static 'images/social/movilidad.png' %}'); }
        .accordion-event [data-item="segundo"] { background-image: url('{% static 'images/social/logistica.png' %}'); }
        .accordion-event [data-item="tercero"] { background-image: url('{% static 'images/social/verde.png' %}'); }
        .estra-item .estra-info { display: none; }
        .estra-item.show-info .estra-info { display: block; }
    </style>
{% endblock %}

{% block wrapper %}
    <section id="nuestro-talento" class="py-5">
        <div class="container text-center">
            <h1 class="mb-5" style="color: #d0df00;">Nuestro Talento</h1>
            <div class="row">
                <div class="col-md-4">
                    <div class="talento-card">
                        <img src="{% static 'images/social/icono.png' %}" alt="Capital humano" class="talento-icon">
                        <h3>Capital humano</h3>
                        <p>
                            Consideramos que el talento humano es nuestro activo más valioso. Nuestra filosofía de
                            gestión pone a las personas en el centro, fomentando relaciones duraderas basadas en la
                            confianza, el respeto y el crecimiento mutuo.
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="talento-card">
                        <img src="{% static 'images/social/icono-laborales.png' %}" alt="Prácticas laborales"
                             class="talento-icon">
                        <h3>Prácticas laborales</h3>
                        <p>
                            Respetar las prácticas laborales justas y mantener relaciones laborales positivas resulta
                            fundamental para la continuidad operativa, especialmente en sectores con representación
                            sindical.
                        </p>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="talento-card">
                        <img src="{% static 'images/social/icono-derechos.png' %}" alt="Derechos humanos"
                             class="talento-icon">
                        <h3>Derechos humanos</h3>
                        <p>
                            El respeto a los derechos humanos forma parte esencial de nuestros valores corporativos y
                            guía el comportamiento de todos los colaboradores de la organización.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="iniciativas">
        <div class="container mb-5 mt-5">
            <div class="transporte-container">
                <div class="transporte-card" data-card=""
                     style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url({% static 'images/social/sistema_salud.png' %}); background-position: center;background-size: cover;">
                    <h3 class="text-white text-bold">Sistema de Gestión de Seguridad y Salud</h3>
                    <div class="card-content text-left">En 2024, tuvimos avances considerables en la implementación de
                        nuestro
                        Sistema de Gestión de Salud y Seguridad Ocupacional alineado con la norma ISO 45001. Este
                        sistema se está desplegando progresivamente en todas las unidades de negocio y, como parte de
                        este proceso, trabajamos para obtener la certificación de dos unidades de negocio en 2025.
                    </div>
                    <button class="card-button">Regresar</button>
                </div>
                <div class="transporte-card" data-card=""
                     style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url({% static 'images/social/programa_salud.png' %}); background-position: center;background-size: cover;">
                    <h3 class="text-white text-bold">Programas de Seguridad y Salud Operacional</h3>
                    <div class="card-content text-left">Nuestros programas de seguridad y salud ocupacional se
                        fundamentan en
                        procesos estructurados de identificación de peligros, evaluación de riesgos e implementación de
                        controles efectivos en todas nuestras unidades de negocio.
                    </div>
                    <button class="card-button">Regresar</button>
                </div>
                <div class="transporte-card" data-card=""
                     style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url({% static 'images/social/gestion_seguridad.png' %}); background-position: center;background-size: cover;">
                    <h3 class="text-white text-bold text-left">Sistema de Gestión de Seguridad Vial</h3>
                    <div class="card-content text-left">Continuamos fortaleciendo nuestro Sistema de Gestión de la
                        Seguridad Vial,
                        que cuenta con la certificación ISO 39001 en tres de nuestras unidades de negocio. Este sistema
                        provee una estructura para prevenir incidentes viales y se sustenta en una serie de políticas y
                        procedimientos robustos.
                    </div>
                    <button class="card-button">Regresar</button>
                </div>
                <div class="transporte-card" data-card=""
                     style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url({% static 'images/social/salud_bienestar.png' %}); background-position: center;background-size: cover;">
                    <h3 class="text-white text-bold">Salud y Bienestar</h3>
                    <div class="card-content text-left">El Área Corporativa de Salud Ocupacional coordinó una red de 66
                        consultorios médicos en todas nuestras unidades de negocio, mismas que emplean a 83
                        profesionales de la salud, entre médicos y enfermeras.
                    </div>
                    <button class="card-button">Regresar</button>
                </div>
            </div>
        </div>
    </section>

    <section id="integracion" class="content-wrap container-fluid">
        <div id="diversidad_colaboradores" class="container pt-5 pb-5">
            <div class="row justify-content-center text-center">
                <div class="col-6">
                    <h1 class="salud" style="color: #d0df00;">Atracción y Retención</h1>
                    <p class="text-left">
                        En una industria altamente competitiva e intensiva en mano de obra, hemos adoptado un enfoque
                        proactivo y estratégico para identificar, seleccionar y contratar a profesionistas calificados
                        que
                        se alinean con las necesidades y cultura de nuestro negocio.
                    </p>
                    <img src="/static/images/social/accion_retencion.png" class="img-fluid mt-3"
                         alt="Atracción y Retención">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4 d-flex justify-content-center align-items-center p-5"
                 style="background-image: url({% static 'images/social/img1.png' %});">
                <div class="layer"></div>
                <h3 class="text-center text-white font-weight-bold" style="font-size: 24px!important;">La seguridad vial
                    es fundamental de nuestras operaciones, dada la naturaleza de nuestro negocio, tenemos que proteger
                    tanto a los operadores como a los pasajeros.</h3>
            </div>
            <div class="col-md-4 mb-4 d-flex justify-content-center align-items-center p-5"
                 style="background-image: url({% static 'images/social/img2.png' %});">
                <div class="layer"></div>
                <h3 class="text-center text-white font-weight-bold" style="font-size: 24px!important;">Monitoreamos de
                    cerca los horarios laborales y las horas extras para garantizar que todos los colaboradores tengan
                    una carga laboral equilibrada.</h3>
            </div>
            <div class="col-md-4 mb-4 d-flex justify-content-center align-items-center p-5"
                 style="background-image: url({% static 'images/social/img3.png' %});">
                <div class="layer"></div>
                <h3 class="text-center text-white font-weight-bold" style="font-size: 24px!important;">Para fortalecer
                    las capacidades de liderazgo y promover la movilidad interna, ofrecemos programas de desarrollo
                    específicos en distintos niveles de la organización.</h3>
            </div>
        </div>
    </section>

    <div id="fuerza_laboral" class="content-wrap">
        <div class="container" id="diversidad">
            <div class="row align-items-center">
                <div class="col-12 col-lg-6 mb-4 mb-lg-0">
                    <h1 class="text-center" style="color: #d0df00;">
                        Fuerza Laboral
                    </h1>
                    <p style="text-align: left;">Al cierre de 2024, nuestro equipo de colaboradores acumuló un total de
                        <strong>21,303 colaboradores</strong>, de los cuales el <strong>
                                82.7%</strong> correspondían al sexo masculino y el <strong>17.3%</strong> al femenino,
                        distribuidos de la siguiente manera:</p>
                </div>
                <div class="col-12 col-lg-6 d-flex justify-content-center">
                    <div id="graf" style="height: 350px; width: 100%; max-width: 420px;"></div>
                    <div class="w-100 d-flex justify-content-start" style="max-width: 120px;">
                        <div style="font-weight: bold; font-size: 14px; color: #333; margin-top: 220px;">
                            Total = 21,303
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <section class="bg-gray-fmty gestion pb-4" id="n-gestion" style="background-color: #efefef;">
        <div class="container-fluid container-relative">
            <div class="  container">
                <h1 class="text-center" style="color: #d0df00; font-size: 1.8em;">Rotación de Personal</h1>
            </div>
            <div class="row justify-content-center" style="width: 80%; margin: 0 auto;">
                <div class="row text-center">
                    <div class="col-md-6">
                        <div class="caja" style="border: 2px #2D4972 solid;">
                            <h3 style="font-weight: bold; color: #243881">La tasa de rotación del año fue de 102.3%, 9.4
                                puntos porcentuales por debajo del año anterior.</h3>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="caja" style="border: 2px #2D4972 solid;">
                            <h3 style="font-weight: bold; color: #243881">21,668 empleados fueron contratados en el año,
                                un nivel de contratación que responde al crecimiento de nuestro negocio.</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    {#    <div id="comunidad" style="background-color: #efefef;">#}
    {#        <div class="container pt-5">#}
    {#            <h1 id="" class="text-center wow fadeInUp" data-wow-duration="2s"#}
    {#                style="color: #012E81;">#}
    {#                Apoyo a la comunidad</h1>#}
    {#            <p class="text-justify wow fadeInUp" data-wow-duration="2s" style="margin-bottom: 0;">En FINSA mantenemos un firme compromiso con el <strong>bienestar y desarrollo de las comunidades</strong> donde operamos. A través de nuestra Fundación y de alianzas clave, impulsamos iniciativas que generan un impacto positivo y duradero, contribuyendo a <strong>mejorar la calidad de vida</strong> de las personas y promoviendo un crecimiento sostenible e incluyente.</p>#}
    {#        </div>#}
    {#    </div>#}
    <!---MAPA-->
    <section id="boxes-index" style="">
        <div class="card-group">
            <div class="card">
                <h3 class="text-white text-bold">Desarrollo Profesional y Laboral</h3>
                <img class="card-img-top" src="{% static 'images/social/desarrollo_prof.png' %}" alt="Card image cap">
                <div class="card-body d-flex text-center justify-content-center align-items-center"
                     style="background-color: #314597 !important;">
                    <p>
                        <strong>Estamos comprometidos con construir una fuerza laboral habilitada, resiliente y
                            adaptable a través de programas integrales de capacitación y desarrollo adaptados a las
                            necesidades específicas de cada segmento de negocio y nivel desde operadores hasta
                            directores.</strong>
                    </p>
                </div>
            </div>
            <div class="card">
                <h3 class="text-white text-bold">Formación y Educación</h3>
                <img class="card-img-top" src="{% static 'images/social/forma_educ.png' %}" alt="Card image cap">
                <div class="card-body d-flex text-center justify-content-center align-items-center"
                     style="background-color: #314597 !important;">
                    <p>
                        <strong>Durante 2024, invertimos $47.3 millones de pesos en capacitación. Nuestros programas se
                            imparten a través de una combinación de plataformas virtuales, cursos presenciales y centros
                            especializados, con lo que logramos que el aprendizaje sea más accesible y
                            efectivo.</strong>
                    </p>
                </div>
            </div>
        </div>
    </section>
    <section class="bg-gray-fmty estrategia" id="cultura">
        <div class="container-fluid container-relative">
            <div class="row align-items-center justify-content-center preguntas-finales">
                <div class="col-12 col-xl-5 col-lg-6 col-md-10 padding-6-rem-tb lg-padding-5-rem-tb lg-padding-2-half-rem-right md-padding-15px-right md-no-padding-tb md-margin-5-rem-bottom">
                    <h1 class="mt-5 mt-lg-0 alt-font font-weight-500 texto-cenizo letter-spacing-minus-1px margin-4-half-rem-bottom md-margin-4-rem-bottom lg-margin-2-half-rem-bottom md-w-100"
                        style="color: #243881;">
                        Fundaciones
                    </h1>
                    <div class="panel-group accordion-event accordion-style-03 margin-4-rem-bottom lg-margin-2-rem-bottom">
                        <div data-item="primero"
                             class="estra-link panel box-shadow-small border-radius-5px wow animate__fadeInUp animated"
                             data-wow-delay="0.6s" style="visibility: visible; animation-delay: 0.6s; background-image: url({% static 'images/social/movilidad.png' %}); background-position: center; background-size: cover;">
                            <div class="panel-heading">
                                <div class="boton-info1">
{#                                    <span>Movilidad Social</span>#}
                                    <i class="indicator fa fa-angle-right text-tussock icon-extra-small"></i>
                                </div>
                            </div>
                        </div>
                        <div data-item="segundo"
                             class="estra-link panel box-shadow-small border-radius-5px wow animate__fadeInUp animated"
                             data-wow-delay="0.6s" style="visibility: visible; animation-delay: 0.6s; background-image: url({% static 'images/social/logistica.png' %}); background-position: center; background-size: cover;">
                            <div class="panel-heading">
                                <div class="boton-info1">
{#                                    <span>Logística Social</span>#}
                                    <i class="indicator fa fa-angle-right text-tussock icon-extra-small"></i>
                                </div>
                            </div>
                        </div>
                        <div data-item="tercero"
                             class="estra-link panel box-shadow-small border-radius-5px wow animate__fadeInUp animated"
                             data-wow-delay="0.6s" style="visibility: visible; animation-delay: 0.6s; background-image: url({% static 'images/social/verde.png' %}); background-position: center; background-size: cover;">
                            <div class="panel-heading">
                                <div class="boton-info1">
{#                                    <span>Voluntariado y Medio Ambiente</span>#}
                                    <i class="indicator fa fa-angle-right text-tussock icon-extra-small"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6 offset-xl-1 col-md-10 estra-item primero"
                     style="visibility: visible; animation-name: fadeInRight;">
                    <div class="outside-box-right position-relative">
                        <img src="/static/images/social/fundaciones.png" class="overflow-hidden">
                        <div class="estra-info">
                            <p class="font">Brindar oportunidades educativas para reducir la desigualdad y promover el
                                crecimiento profesional.</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6 offset-xl-1 col-md-10 estra-item segundo d-none"
                     style="visibility: visible; animation-name: fadeInRight;">
                    <div class="outside-box-right position-relative">
                        <img src="/static/images/social/fundaciones.png" class="overflow-hidden">
                        <div class="estra-info">
                            <p class="font">Apoyar a organizaciones sin fines de lucro mediante el transporte de
                                personas y bienes, especialmente durante situaciones de emergencia.</p>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-lg-6 offset-xl-1 col-md-10 estra-item tercero d-none"
                     style="visibility: visible; animation-name: fadeInRight;">
                    <div class="outside-box-right position-relative">
                        <img src="/static/images/social/fundaciones.png" class="overflow-hidden">
                        <div class="estra-info">
                            <p class="font">Involucrar a colaboradores y comunidades en actividades que promueven la
                                protección del medio ambiente y el bienestar social.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block otherscripts %}
    <script src="{% static 'javascripts/js/jquery.js' %}"></script>
    <script src="{% static 'javascripts/js/plugins.js' %}"></script>
    <script src="{% static 'javascripts/js/functions.min.js' %}"></script>
    <script src="{% static 'javascripts/jquery.waypoints.min.js' %}"></script>
    <script src="{% static 'javascripts/countTo.js' %}"></script>
    <script src="{% static 'javascripts/owl.carousel.min.js' %}"></script>
    <script src="{% static 'javascripts/maps-states-mx.js' %}"></script>
    <script src="{% static 'javascripts/amcharts/amcharts.js' %}"></script>
    <script src="{% static 'javascripts/amcharts/pie.js' %}"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const fragment = window.location.hash;

            if (fragment.includes("tab=")) {
                const tabId = fragment.split("tab=")[1];

                $('#myTab a[href="#' + tabId + '"]').tab('show');

                $('html, body').animate({
                    scrollTop: $("#ppropiedades").offset().top
                }, 500, function () {
                    setTimeout(function () {
                        $('#myTab a[href="#' + tabId + '"]').tab('show');
                    }, 100);
                });
            }
        });

        $(".owl-carousel1").owlCarousel({
            loop: false, // Deshabilita el bucle
            center: false,
            margin: 0,
            responsiveClass: true,
            nav: false,
            drag: false,
            touchDrag: false,
            mouseDrag: false,
            pullDrag: false,
            freeDrag: false,
            responsive: {
                0: {
                    items: 1,
                    nav: false
                },
                680: {
                    items: 1,
                    nav: false,
                    loop: false
                },
                1000: {
                    items: 3,
                    nav: false
                }
            },
            onInitialized: removeBlurEffect,
            onTranslated: removeBlurEffect
        });

        // Deshabilitar el desplazamiento manual
        $(".owl-carousel1").on('drag.owl.carousel', function (e) {
            e.preventDefault();
        });
        $(".owl-carousel1").on('mousewheel.owl.carousel', function (e) {
            e.preventDefault();
        });

        function removeBlurEffect() {
            // Remueve cualquier clase que aplique opacidad
            $(".owl-item").removeClass("blurred");
            $(".owl-item").css("opacity", "1");
            $(".owl-item").css("transform", "scale(1)");
        }

        // Donut Fuerza Laboral
        document.addEventListener('DOMContentLoaded', function () {
            if (typeof AmCharts === 'undefined') return;
            var graf = AmCharts.makeChart("graf", {
                "type": "pie",
                "theme": "light",
                "colors": ["#243881", "#e87722"], // Mujeres (azul), Hombres (naranja)
                "dataProvider": [
                    { "categoria": "Mujeres", "valor": 3677 },
                    { "categoria": "Hombres", "valor": 17626 }
                ],
                "titleField": "categoria",
                "valueField": "valor",
                "innerRadius": "68%",
                "radius": "32%",
                "labelsEnabled": true,
                "labelText": "[[value]]",
                "labelRadius": 15,
                "labelTickAlpha": 0.4,
                "labelTickColor": "#888888",
                "labelTickLength": 8,
                "minAngle": 5,
                "legend": {
                    "position": "right",
                    "align": "left",
                    "markerType": "square",
                    "labelText": "[[title]]",
                    "valueText": "",
                    "equalWidths": true,
                    "maxColumns": 1
                }
            });

            function placeIcons() {
                try {
                    var svg = graf.chartDiv.getElementsByTagName('svg')[0];
                    if (!svg || !graf.chartData) return;
                    var oldIcons = svg.querySelectorAll('.label-icon');
                    oldIcons.forEach(function(n){ n.remove(); });
                    graf.chartData.forEach(function(cd){
                        if (!cd.label || !cd.label.node) return;
                        var tr = cd.label.node.getAttribute('transform');
                        if (!tr) return;
                        var m = /translate\(([-\d\.]+),\s*([-\d\.]+)\)/.exec(tr);
                        if (!m) return;
                        var lx = parseFloat(m[1]);
                        var ly = parseFloat(m[2]);
                        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');
                        img.setAttributeNS(null, 'x', lx - 45);
                        img.setAttributeNS(null, 'y', ly - 45);
                        img.setAttributeNS(null, 'width', 38);
                        img.setAttributeNS(null, 'height', 38);
                        img.setAttribute('class', 'label-icon');
                        var href = (cd.title === 'Mujeres') ? '/static/images/social/icono4.png' : '/static/images/social/icono5.png';
                        img.setAttributeNS('http://www.w3.org/1999/xlink', 'href', href);
                        svg.appendChild(img);
                    });
                } catch(e) {}
            }
            graf.addListener('init', placeIcons);
            graf.addListener('rendered', placeIcons);
            // Mostrar total debajo de la leyenda (usar init y rendered para asegurar disponibilidad del DOM)
            function placeTotal() {
                try {
                    var container = graf.chartDiv;
                    if (!container) return;
                    var legendDiv = container.querySelector('.amcharts-legend-div');
                    // Si aún no existe la leyenda, reintentar en breve
                    if (!legendDiv) {
                        setTimeout(placeTotal, 50);
                        return;
                    }
                    var old = container.querySelector('.total-container');
                    if (old) old.remove();
                    var totalDiv = document.createElement('div');
                    totalDiv.className = 'total-container';
                    totalDiv.style.width = 'auto';
                    totalDiv.style.marginTop = '6px';
                    totalDiv.style.textAlign = 'left';
                    totalDiv.style.fontWeight = 'bold';
                    totalDiv.style.fontSize = '14px';
                    totalDiv.style.color = '#333';
                    totalDiv.innerHTML = 'Total = <span style=\"font-weight:bold;\">21,303</span>';
                    legendDiv.parentNode.insertBefore(totalDiv, legendDiv.nextSibling);
                } catch (e) {}
            }
            graf.addListener('init', placeTotal);
            graf.addListener('rendered', placeTotal);
        });

        var counter = 1,
            interval = setInterval(function () {
                var elemento = $("#n-estrategia").find(".estra-link ")[counter];
                $(elemento).click();
                if (counter === 3) {
                    counter = 0;
                } else {
                    counter++;
                }
            }, 20000);
        $('#n-estrategia .outside-box-right').mouseover(function () {
            clearInterval(interval)
        });

        $('#n-estrategia .outside-box-right').mouseleave(function () {
            interval = setInterval(function () {
                var elemento = $("#n-estrategia").find(".estra-link")[counter];
                $(elemento).click();
                if (counter === 3) {
                    counter = 0;
                } else {
                    counter++;
                }
            }, 20000)
        });

        $(".estra-link").on('click', function (event) {
            var $this = $(this);
            var item = $this.data('item');
            $(".estra-item").addClass('d-none').removeClass('show-info');
            $(".estra-link").removeClass('active');
            $this.addClass('active');
            $('.estra-item.' + item).removeClass("d-none").addClass('show-info');
        });

        $(window).on('load', function () {
            new WOW().init();
            $('.finn-counto').each(function () {
                finn_waypoint('#' + $(this).attr('id'));
                finn_counto('#' + $(this).attr('id'));
            });

        });

        function finn_waypoint(elemento) {
            var waypoint = new Waypoint({
                element: $(elemento),
                handler: function (direction) {
                    $(elemento + ' .count').trigger('on-appear');
                },
                offset: '75%',
                triggerOnce: true
            })
        }

        function finn_counto(elemento) {
            if ($().countTo) {
                $(elemento + ' .count').on('on-appear', function () {
                    $(elemento + ' .honeycomb-path.honeycomb-1').addClass('honeycomb-animated');

                    $(this).each(function () {
                        var to = parseFloat($(this).data('to')),
                            speed = parseInt($(this).data('speed')),
                            decimals = parseInt($(this).data('decimals'));

                        $(this).countTo({
                            to: to,
                            speen: speed,
                            decimals: decimals,
                            formatter: function (value, options) {
                                return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
                            },
                            onComplete: function (value) {


                                return this.innerHTML;
                            }

                        });
                    });
                }); //counter
            }
        }
    </script>
    <script>
        $(window).on('load', function () {

            $("path.st0, path.st3")
                .click(function () {
                    let id = $(this).attr("id") ?? $(this).data("id");

                    {#activo css#}
                    $('path.active').removeClass('active');
                    $("#" + id).attr("class", "st0 active");

                    $("#propiedades-circle").attr("style", "opacity:1;left:-40px");
                    {#$("#propiedades-state").text($(this).attr("name"));#}
                    $("#propiedades-state").text(mxStates[id].name);

                    let divText = $("#propiedades-text");
                    divText.empty();
                    let list = mxStates[id].list;
                    if (list.length) {
                        for (let i of list) {
                            divText.append('<h4>' + i.title + '</h4>');
                            if (i.items.length) {
                                let ul = '<ul class="list-group list-unstyled">';
                                for (let j of i.items) {
                                    ul += '<li class="list-unstyled">' + j + '</li>';
                                }
                                ul += '</ul>';
                                divText.append(ul);
                            }
                        }
                    }
                });

            $("[id='MEX2712']").click();
        });
        $(document).ready(function () {
            // Function to format number with commas
            function numberWithCommas(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            // Initialize counters with waypoints
            $('.finn-counto .count').each(function () {
                var $this = $(this);
                var $button = $this.closest('button');

                // Start the honeycomb animation by adding a class to the SVG element
                var animateHoneycomb = function ($element) {
                    $element.closest('.honeycomb').find('svg.honeycomb-path').addClass('honeycomb-animated');
                };

                $this.waypoint(function () {
                    // Delay the counting to ensure it's visible
                    setTimeout(function () {
                        // Trigger the honeycomb animation
                        animateHoneycomb($this);
                        $button.addClass('animation-trigger');

                        $this.countTo({
                            from: 0,
                            to: $this.data('to'),
                            speed: $this.data('speed'),
                            decimals: $this.data('decimals'),
                            onUpdate: function (value) {
                                var prefix = $this.data('prefix') ? $this.data('prefix') + ' ' : '';
                                var isPercent = $this.data('porcent') === true || $this.data('porcent') === "true";
                                var displayValue = isPercent ? value.toFixed($this.data('decimals')) + '%' :
                                    numberWithCommas(value.toFixed($this.data('decimals')));
                                $this.text(prefix + displayValue);
                            },
                            onComplete: function (value) {
                                // This ensures the class is only added once at the beginning of counting
                                var prefix = $this.data('prefix') ? $this.data('prefix') + ' ' : '';
                                var isPercent = $this.data('porcent') === true || $this.data('porcent') === "true";
                                var displayValue = isPercent ? value.toFixed($this.data('decimals')) + '%' :
                                    numberWithCommas(value.toFixed($this.data('decimals')));
                                $this.text(prefix + displayValue);
                            }
                        });
                    }, $this.data('delay') || 0);

                    this.destroy(); // Ensures the animation and counting occur only once
                }, {
                    offset: '80%', // Triggers when the element is 75% from the top of the viewport
                    triggerOnce: true // Counting should only happen once
                });
            });
            $(".modal-directivo").click(function (e) {
                e.preventDefault();
                let target = $(e.currentTarget);
                $("#DirectiveModal1 .directivo-img").attr('src', target.data('img'));
                $("#DirectiveModal1 .directivo-name").text(target.data('name'));
                $("#DirectiveModal1 .directivo-description").text(target.data('description'));
                $("#DirectiveModal1 .directivo-position").text(target.data('position'));
                $("#DirectiveModal1").modal('show');
            });
            $("#DirectiveModal1 .close-btn").click(function (e) {
                $("#DirectiveModal1").modal('hide');
            });
        });


    </script>

    <script>
        $('.owl-carousel').owlCarousel({
            loop: true,
            margin: 30,
            nav: true,
            autoplay: true,
            autoplayTimeout: 45000,
            autoplayHoverPause: true,
            items: 1,
        });
    </script>




    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const cards = document.querySelectorAll(".transporte-card");

            cards.forEach(card => {
                const title = card.querySelector("h3");
                const button = card.querySelector(".card-button");

                title.addEventListener("click", () => {
                    cards.forEach(c => c.classList.remove("expanded", "collapsed"));
                    card.classList.add("expanded");
                    cards.forEach(c => {
                        if (c !== card) c.classList.add("collapsed");
                    });
                });

                button.addEventListener("click", () => {
                    cards.forEach(c => c.classList.remove("expanded", "collapsed"));

                    cards.forEach(c => {
                        const h3 = c.querySelector("h3");
                        h3.style.transition = "font-size 0.5s ease";
                        h3.style.fontSize = "28px"; // tamaño mayor temporal
                        setTimeout(() => (h3.style.fontSize = "24px"), 800); // vuelve a normal
                    });
                });
            });
        });
    </script>

{% endblock %}